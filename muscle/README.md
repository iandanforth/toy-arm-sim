
# Architecture

Fibrils make up fibers (not going to model these directly)
Fibers are grouped into motor units
Motor units make up muscles

# What can change over long periods of time (hours+)?

The number of fibrils in a fiber can change, which increases the maximum force output of the fiber.

The fatigability of a given muscle can change with habitual activity

# What can change over short periods of time (seconds) ?

The set of motor units that are activated in a muscle.

The strength that any motor neuron innervates a fiber can change.

The amount of force generated by a muscle for the same activation.

# What doesn't change?

The total number of muscle fibers
The total number of muscles

The number of motor units can change during development or old age but is largely stable during adulthood.

# Goal

Provide a realistic abstraction for learning and experimenting with motor control.

# How do we deal with time?

# Human motor units need to be activated at 80 to 100 pps (pulses per second) to reach maximal force. Enoka, 2008, Chapter 6, pg. 220 (4th Ed.) - file:///Users/iandanforth/Downloads/Enoka.pdf
# Note the above was determined using induced action potentials. Such high values are rare in voluntary motor unit activation.



# Toy Sensory Motor Problem

              |---| 
     *        | 0 |
     *          *
      *       *
        *   * 
          * 

Imagine an arm, holding a ball. The arm must raise the ball into a target area and hold it there.

The only motion allowed is at the elbow.

All physics are modeled in a 2D simulation.

Motion of the arm is produced by changing the stiffness of springs attached to the upper and lower parts of the arm.

As stiffness changes the force a spring produces in an effort to reach its resting length changes.

For the spring above the elbow joint, to lower the arm the spring's stiffness must be reduced.

To raise the arm the spring's stiffness must be increased.

Brachialis and Tricep muscles are modeled such that activations in a population of simulated motor neurons change the stiffness of the springs.

The agent is given raw scene pixels and proprioceptive readouts as inputs.

The agent must learn how to control the arm by translating world state observations into the correct set of motor unit activations to raise the ball to the target area and hold it there.

The agent receives a small reward for the ball approaching the target area and a large reward for the ball being in the target area.


# Proprioception

The brain does not recieve a direct readout of how much force a muscle is producing, the current angle of a given joint, or how far a muscle has been stretched. These values, and more, are encoded by several types of mechanoreceptors embedded in muscles and tendons.

Muscle Spindles (Kandel 794)

Parrallel to standard contractile muscle fibers run encapsulated intrafusal fibers. These fibers are wrapped in afferent neuron axons and sense change in muscle length and total muscle stretch.

The intrafusal fibers can be divided into nuclear bag fibers and nuclear chain fibers. Nuclear bag fibers can be further divided into dynamic and static fibers.

Dynamic nuclear bag fibers are highly sensitive to changes in muscle length.

Static nuclear bag fibers are sensitive to steady-state tension, thus their activity levels are directly correlated with the current length of extrafusal muscle.

Importantly the sensitivity of these fibers can be influenced by the central nervous system through *gamma* motor neurons. These motor neurons cause contraction in intrafusal fibers, but this does not contribute meaningfully to the force produced by a muscle. Instead by adjusting the tension of intrafusal fibers, they become more or less sensitive to stretch or tonic tension.

# Varying force in skeletal muscle

There are two primary ways to change the output force obtained from a muscle, recruitment and rate coding. Recruitment involes changing the number of motor units that are active in a muscle. Rate coding means changing the rate of action-potentials that are stimulating motor units. (Fugelvand 1993)

For large muscles that require less precision and a greater range of force output recruitment may be the primary method of force control, whereas in muslces of the hand that control fine finger movements rate-coding may be the primary controller of force.

# Motorneuron model

(E) Excitatory Drive - the net input seen at the trigger zone due to all synaptic sources active during voluntary muscle contraction.

(RTE) Recruitment Threshold Excitiation - the minimum level of excitatory drive required to initiatate repetitive discharge in a motorneuron.

"All motor neurons were modeled to receive the same level of excitatory drive" - WHAT?! 

Motor neurons within a pool have a broad range of excitability. Some neurons require 10-30x the excitation to initiate repetitive discharge when compared to the most easily excited neurons.

Most motor neurons in a pool are easily excited and only a few are not. To model this distribution of RTE an exponential was used:

recruitment_range = 30 // A value between 10 and 30
n = 120 // Total number of neurons in the pool
a = ln(recruitment_range) / n
for i in range(n):
  RTE(i) = pow(math.e, a * i)

Thus where i == 1, RTE == 1.0 and where i == 120, RTE == 30.0

NOTE: WILL NEED TO SHUFFLE, ALSO assign peak force at same time

(MFR) - Minimal firing rate

During voluntary muscle contraction the minimal firing rate following recruitment is consistent across motor neurons regardless of their excitation threshold. (Fuglevand 1993)

MFR = 8 impulses / second

(FR) - Firing Rate

The firing rate at a given time is linearly related to the exihitation drive (E).

FR = g * (E - RTE) + MFR

g, the gain, was given the same value for all motor neurons.

(PFR) - Peak Firing Rate, which in humans is observed to be between 20 and 45 imp /s

(ISI) - Interspike interval (inversely proportional to firing rate)

ISI coefficient of variation is between 0.1 and 0.3 in normal humans - IGNORE? OPTIONAL NOISE?

ASIDE: Because of frame locking should this be modeled as a drop-out like mask on motor neuron outputs prior to calculating force? Probs.

# Force output model

p = // peak amplitute of twitch force
T = // rise time (contraction time) to peak force
alpha = p * (math.e / t)
force = a * t * pow(math.e, (-t / T))

Twitch force - This varies widely between motor units in a motor pool. The force produced by the strongest unit can be >100x that of the weakest.

Just like activation threshholds there are a large number of units in a given pool that produce a small amount of force and a small number that produce large forces.

Motor units peak force is positively correlated with RTE.

n = 120 // motor unit count
peak_force_range = 100 // could be greater
b = math.ln(peak_force_range) / n
for i in range(n):
  peak_force = pow(math.e, (b * i)) // Called P in the paper

Thus where i == 1, P == 1 and where i == 120, P == 100
